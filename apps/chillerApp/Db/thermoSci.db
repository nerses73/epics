# 
# Thermo Scientific Refrigerated Bath
# 
# 
# Notes:
#   [Macros]
#   P     - standard record prefix
#   R     - standard record prefix
#   PORT  - asyn port name
#
# Author: Wesley Moore
# Date:   Dec 2014
#


record(asyn, "$(P)$(R)ASYN") {
    field(PORT, "$(PORT)")
}

#######################################
# Control Commands
#######################################
record(bo, "$(P)$(R)ONOFF") {
	field(DTYP, "stream")
	field(OUT,  "@thermoSci.proto setOnOff $(PORT)")
	field(ZNAM, "Off")
	field(ONAM, "On")
}

# ASLO set to multiply setpoint by 10 before sending to chiller.
record(ao, "$(P)$(R)TEMP:SP") {
	field(DTYP, "stream")
	field(OUT,  "@thermoSci.proto SetSetpt $(PORT)")
	field(ASLO, "0.1")
	field(EGU,  "C")
	field(PREC, "1")
}

# ASLO set to multiply setpoint by 10 before sending to chiller.
record(ao, "$(P)$(R)LOW_LIMIT:SP") {
	field(DTYP, "stream")
	field(OUT,  "@thermoSci.proto SetLowLim $(PORT)")
	field(ASLO, "0.1")
	field(EGU,  "C")
	field(PREC, "1")
}

# ASLO set to multiply setpoint by 10 before sending to chiller.
record(ao, "$(P)$(R)HIGH_LIMIT:SP") {
	field(DTYP, "stream")
	field(OUT,  "@thermoSci.proto SetHighLim $(PORT)")
	field(ASLO, "0.1")
	field(EGU,  "C")
	field(PREC, "1")
}

#######################################
# Status Commands
#######################################
record(mbbi, "$(P)$(R)STATUS1") {
    field(DTYP, "stream")
    field(INP, "@thermoSci.proto getStatus($(P)$(R)STATUS) $(PORT)")
    field(NOBT, "8")
    field(SCAN, "1 second")
}
record(mbbi, "$(P)$(R)STATUS2") {
    field(NOBT, "8")
}
record(mbbi, "$(P)$(R)STATUS3") {
    field(NOBT, "8")
}
record(mbbi, "$(P)$(R)STATUS4") {
    field(NOBT, "8")
}
record(mbbi, "$(P)$(R)STATUS5") {
    field(NOBT, "8")
}

record(ai, "$(P)$(R)TEMP") {
    field(DTYP, "stream")
    field(INP, "@thermoSci.proto getTemp $(PORT)")
    field(PINI, "1")
    field(ASLO, "0.1")
    field(EGU,  "C")
    field(PREC, "1")
    field(SCAN, "1 second")
}

record(ai, "$(P)$(R)TEMP:RD_SP") {
    field(DTYP, "stream")
    field(INP,  "@thermoSci.proto getSetpt $(PORT)")
    field(ASLO, "0.1")
    field(PREC, "1")
    field(SCAN, "1 second")
}

record(ai, "$(P)$(R)LOW_LIMIT") {
    field(DTYP, "stream")
    field(INP,  "@thermoSci.proto getLowLim $(PORT)")
    field(ASLO, "0.1")
    field(PREC, "1")
    field(SCAN, "1 second")
}

record(ai, "$(P)$(R)HIGH_LIMIT") {
    field(DTYP, "stream")
    field(INP,  "@thermoSci.proto getHighLim $(PORT)")
    field(ASLO, "0.1")
    field(PREC, "1")
    field(SCAN, "1 second")
}

#
# PID values are ready, but not needed. 
#

#record(ai, "$(P)$(R)HEAT:P") {
#    field(DTYP, "stream")
#    field(INP,  "@thermoSci.proto getHeatP $(PORT)")
#    field(ASLO, "0.1")
#    field(PREC, "1")
#    field(SCAN, "10 second")
#}

#record(ai, "$(P)$(R)HEAT:I") {
#    field(DTYP, "stream")
#    field(INP,  "@thermoSci.proto getHeatI $(PORT)")
#    field(ASLO, "0.01")
#    field(PREC, "2")
#    field(SCAN, "10 second")
#}

#record(ai, "$(P)$(R)HEAT:D") {
#    field(DTYP, "stream")
#    field(INP,  "@thermoSci.proto getHeatD $(PORT)")
#    field(ASLO, "0.1")
#    field(PREC, "1")
#    field(SCAN, "10 second")
#}

#record(ai, "$(P)$(R)COOL:P") {
#    field(DTYP, "stream")
#    field(INP,  "@thermoSci.proto getCoolP $(PORT)")
#    field(ASLO, "0.1")
#    field(PREC, "1")
#    field(SCAN, "10 second")
#}

#record(ai, "$(P)$(R)COOL:I") {
#    field(DTYP, "stream")
#    field(INP,  "@thermoSci.proto getCoolI $(PORT)")
#    field(ASLO, "0.01")
#    field(PREC, "2")
#    field(SCAN, "10 second")
#}

#record(ai, "$(P)$(R)COOL:D") {
#    field(DTYP, "stream")
#    field(INP,  "@thermoSci.proto getCoolD $(PORT)")
#    field(ASLO, "0.01")
#    field(PREC, "2")
#    field(SCAN, "10 second")
#}
